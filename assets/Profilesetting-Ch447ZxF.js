import{a as ye,g as Ce,s as Y,aO as He,E as qe,_ as x,r as c,u as we,b as pe,c as q,j as o,d as Be,aP as it,aQ as Ue,aR as Xe,aS as _e,aT as ct,aU as dt,aV as de,m as ut,aW as ge,aX as pt,B as ue,C as ie,h as Se,T as oe,G as T,y as V,J as ce,a1 as ht,a2 as te,af as ft,ag as mt,aY as bt,aZ as xt,H as gt,a_ as vt,aI as St,Y as yt,Z as Ct,$ as wt,a0 as Bt}from"./index-CLLn0rYl.js";import{E as jt}from"./appbar-D_RuDL8j.js";import{L as Ae}from"./Link-DsXvNGVM.js";let G;function Ve(){if(G)return G;const e=document.createElement("div"),t=document.createElement("div");return t.style.width="10px",t.style.height="1px",e.appendChild(t),e.dir="rtl",e.style.fontSize="14px",e.style.width="4px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.overflow="scroll",document.body.appendChild(e),G="reverse",e.scrollLeft>0?G="default":(e.scrollLeft=1,e.scrollLeft===0&&(G="negative")),document.body.removeChild(e),G}function It(e,t){const l=e.scrollLeft;if(t!=="rtl")return l;switch(Ve()){case"negative":return e.scrollWidth-e.clientWidth+l;case"reverse":return e.scrollWidth-e.clientWidth-l;default:return l}}function Tt(e){return Ce("MuiTab",e)}const H=ye("MuiTab",["root","labelIcon","textColorInherit","textColorPrimary","textColorSecondary","selected","disabled","fullWidth","wrapped","iconWrapper"]),Pt=["className","disabled","disableFocusRipple","fullWidth","icon","iconPosition","indicator","label","onChange","onClick","onFocus","selected","selectionFollowsFocus","textColor","value","wrapped"],Et=e=>{const{classes:t,textColor:l,fullWidth:d,wrapped:i,icon:a,label:h,selected:v,disabled:m}=e,B={root:["root",a&&h&&"labelIcon",`textColor${qe(l)}`,d&&"fullWidth",i&&"wrapped",v&&"selected",m&&"disabled"],iconWrapper:["iconWrapper"]};return Be(B,Tt,t)},kt=Y(He,{name:"MuiTab",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:l}=e;return[t.root,l.label&&l.icon&&t.labelIcon,t[`textColor${qe(l.textColor)}`],l.fullWidth&&t.fullWidth,l.wrapped&&t.wrapped,{[`& .${H.iconWrapper}`]:t.iconWrapper}]}})(({theme:e,ownerState:t})=>x({},e.typography.button,{maxWidth:360,minWidth:90,position:"relative",minHeight:48,flexShrink:0,padding:"12px 16px",overflow:"hidden",whiteSpace:"normal",textAlign:"center"},t.label&&{flexDirection:t.iconPosition==="top"||t.iconPosition==="bottom"?"column":"row"},{lineHeight:1.25},t.icon&&t.label&&{minHeight:72,paddingTop:9,paddingBottom:9,[`& > .${H.iconWrapper}`]:x({},t.iconPosition==="top"&&{marginBottom:6},t.iconPosition==="bottom"&&{marginTop:6},t.iconPosition==="start"&&{marginRight:e.spacing(1)},t.iconPosition==="end"&&{marginLeft:e.spacing(1)})},t.textColor==="inherit"&&{color:"inherit",opacity:.6,[`&.${H.selected}`]:{opacity:1},[`&.${H.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}},t.textColor==="primary"&&{color:(e.vars||e).palette.text.secondary,[`&.${H.selected}`]:{color:(e.vars||e).palette.primary.main},[`&.${H.disabled}`]:{color:(e.vars||e).palette.text.disabled}},t.textColor==="secondary"&&{color:(e.vars||e).palette.text.secondary,[`&.${H.selected}`]:{color:(e.vars||e).palette.secondary.main},[`&.${H.disabled}`]:{color:(e.vars||e).palette.text.disabled}},t.fullWidth&&{flexShrink:1,flexGrow:1,flexBasis:0,maxWidth:"none"},t.wrapped&&{fontSize:e.typography.pxToRem(12)})),Fe=c.forwardRef(function(t,l){const d=we({props:t,name:"MuiTab"}),{className:i,disabled:a=!1,disableFocusRipple:h=!1,fullWidth:v,icon:m,iconPosition:B="top",indicator:I,label:n,onChange:C,onClick:P,onFocus:b,selected:f,selectionFollowsFocus:S,textColor:y="inherit",value:w,wrapped:L=!1}=d,E=pe(d,Pt),z=x({},d,{disabled:a,disableFocusRipple:h,selected:f,icon:!!m,iconPosition:B,label:!!n,fullWidth:v,textColor:y,wrapped:L}),F=Et(z),N=m&&n&&c.isValidElement(m)?c.cloneElement(m,{className:q(F.iconWrapper,m.props.className)}):m,K=k=>{!f&&C&&C(k,w),P&&P(k)},O=k=>{S&&!f&&C&&C(k,w),b&&b(k)};return o.jsxs(kt,x({focusRipple:!h,className:q(F.root,i),ref:l,role:"tab","aria-selected":f,disabled:a,onClick:K,onFocus:O,ownerState:z,tabIndex:f?0:-1},E,{children:[B==="top"||B==="start"?o.jsxs(c.Fragment,{children:[N,n]}):o.jsxs(c.Fragment,{children:[n,N]}),I]}))});function Wt(e){return(1+Math.sin(Math.PI*e-Math.PI/2))/2}function Mt(e,t,l,d={},i=()=>{}){const{ease:a=Wt,duration:h=300}=d;let v=null;const m=t[e];let B=!1;const I=()=>{B=!0},n=C=>{if(B){i(new Error("Animation cancelled"));return}v===null&&(v=C);const P=Math.min(1,(C-v)/h);if(t[e]=a(P)*(l-m)+m,P>=1){requestAnimationFrame(()=>{i(null)});return}requestAnimationFrame(n)};return m===l?(i(new Error("Element already at target position")),I):(requestAnimationFrame(n),I)}const Rt=["onChange"],Lt={width:99,height:99,position:"absolute",top:-9999,overflow:"scroll"};function zt(e){const{onChange:t}=e,l=pe(e,Rt),d=c.useRef(),i=c.useRef(null),a=()=>{d.current=i.current.offsetHeight-i.current.clientHeight};return it(()=>{const h=Ue(()=>{const m=d.current;a(),m!==d.current&&t(d.current)}),v=Xe(i.current);return v.addEventListener("resize",h),()=>{h.clear(),v.removeEventListener("resize",h)}},[t]),c.useEffect(()=>{a(),t(d.current)},[t]),o.jsx("div",x({style:Lt},l,{ref:i}))}function Nt(e){return Ce("MuiTabScrollButton",e)}const At=ye("MuiTabScrollButton",["root","vertical","horizontal","disabled"]),Ft=["className","slots","slotProps","direction","orientation","disabled"],Ot=e=>{const{classes:t,orientation:l,disabled:d}=e;return Be({root:["root",l,d&&"disabled"]},Nt,t)},$t=Y(He,{name:"MuiTabScrollButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:l}=e;return[t.root,l.orientation&&t[l.orientation]]}})(({ownerState:e})=>x({width:40,flexShrink:0,opacity:.8,[`&.${At.disabled}`]:{opacity:0}},e.orientation==="vertical"&&{width:"100%",height:40,"& svg":{transform:`rotate(${e.isRtl?-90:90}deg)`}})),Dt=c.forwardRef(function(t,l){var d,i;const a=we({props:t,name:"MuiTabScrollButton"}),{className:h,slots:v={},slotProps:m={},direction:B}=a,I=pe(a,Ft),n=_e(),C=x({isRtl:n},a),P=Ot(C),b=(d=v.StartScrollButtonIcon)!=null?d:ct,f=(i=v.EndScrollButtonIcon)!=null?i:dt,S=de({elementType:b,externalSlotProps:m.startScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:C}),y=de({elementType:f,externalSlotProps:m.endScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:C});return o.jsx($t,x({component:"div",className:q(P.root,h),ref:l,role:null,ownerState:C,tabIndex:null},I,{children:B==="left"?o.jsx(b,x({},S)):o.jsx(f,x({},y))}))});function Ht(e){return Ce("MuiTabs",e)}const ve=ye("MuiTabs",["root","vertical","flexContainer","flexContainerVertical","centered","scroller","fixed","scrollableX","scrollableY","hideScrollbar","scrollButtons","scrollButtonsHideMobile","indicator"]),qt=["aria-label","aria-labelledby","action","centered","children","className","component","allowScrollButtonsMobile","indicatorColor","onChange","orientation","ScrollButtonComponent","scrollButtons","selectionFollowsFocus","slots","slotProps","TabIndicatorProps","TabScrollButtonProps","textColor","value","variant","visibleScrollbar"],Oe=(e,t)=>e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:e.firstChild,$e=(e,t)=>e===t?e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:e.lastChild,ae=(e,t,l)=>{let d=!1,i=l(e,t);for(;i;){if(i===e.firstChild){if(d)return;d=!0}const a=i.disabled||i.getAttribute("aria-disabled")==="true";if(!i.hasAttribute("tabindex")||a)i=l(e,i);else{i.focus();return}}},Ut=e=>{const{vertical:t,fixed:l,hideScrollbar:d,scrollableX:i,scrollableY:a,centered:h,scrollButtonsHideMobile:v,classes:m}=e;return Be({root:["root",t&&"vertical"],scroller:["scroller",l&&"fixed",d&&"hideScrollbar",i&&"scrollableX",a&&"scrollableY"],flexContainer:["flexContainer",t&&"flexContainerVertical",h&&"centered"],indicator:["indicator"],scrollButtons:["scrollButtons",v&&"scrollButtonsHideMobile"],scrollableX:[i&&"scrollableX"],hideScrollbar:[d&&"hideScrollbar"]},Ht,m)},Xt=Y("div",{name:"MuiTabs",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:l}=e;return[{[`& .${ve.scrollButtons}`]:t.scrollButtons},{[`& .${ve.scrollButtons}`]:l.scrollButtonsHideMobile&&t.scrollButtonsHideMobile},t.root,l.vertical&&t.vertical]}})(({ownerState:e,theme:t})=>x({overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex"},e.vertical&&{flexDirection:"column"},e.scrollButtonsHideMobile&&{[`& .${ve.scrollButtons}`]:{[t.breakpoints.down("sm")]:{display:"none"}}})),_t=Y("div",{name:"MuiTabs",slot:"Scroller",overridesResolver:(e,t)=>{const{ownerState:l}=e;return[t.scroller,l.fixed&&t.fixed,l.hideScrollbar&&t.hideScrollbar,l.scrollableX&&t.scrollableX,l.scrollableY&&t.scrollableY]}})(({ownerState:e})=>x({position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap"},e.fixed&&{overflowX:"hidden",width:"100%"},e.hideScrollbar&&{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},e.scrollableX&&{overflowX:"auto",overflowY:"hidden"},e.scrollableY&&{overflowY:"auto",overflowX:"hidden"})),Vt=Y("div",{name:"MuiTabs",slot:"FlexContainer",overridesResolver:(e,t)=>{const{ownerState:l}=e;return[t.flexContainer,l.vertical&&t.flexContainerVertical,l.centered&&t.centered]}})(({ownerState:e})=>x({display:"flex"},e.vertical&&{flexDirection:"column"},e.centered&&{justifyContent:"center"})),Yt=Y("span",{name:"MuiTabs",slot:"Indicator",overridesResolver:(e,t)=>t.indicator})(({ownerState:e,theme:t})=>x({position:"absolute",height:2,bottom:0,width:"100%",transition:t.transitions.create()},e.indicatorColor==="primary"&&{backgroundColor:(t.vars||t).palette.primary.main},e.indicatorColor==="secondary"&&{backgroundColor:(t.vars||t).palette.secondary.main},e.vertical&&{height:"100%",width:2,right:0})),Kt=Y(zt)({overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}),De={},Gt=c.forwardRef(function(t,l){const d=we({props:t,name:"MuiTabs"}),i=ut(),a=_e(),{"aria-label":h,"aria-labelledby":v,action:m,centered:B=!1,children:I,className:n,component:C="div",allowScrollButtonsMobile:P=!1,indicatorColor:b="primary",onChange:f,orientation:S="horizontal",ScrollButtonComponent:y=Dt,scrollButtons:w="auto",selectionFollowsFocus:L,slots:E={},slotProps:z={},TabIndicatorProps:F={},TabScrollButtonProps:N={},textColor:K="primary",value:O,variant:k="standard",visibleScrollbar:he=!1}=d,Ye=pe(d,qt),M=k==="scrollable",W=S==="vertical",J=W?"scrollTop":"scrollLeft",re=W?"top":"left",le=W?"bottom":"right",fe=W?"clientHeight":"clientWidth",Z=W?"height":"width",U=x({},d,{component:C,allowScrollButtonsMobile:P,indicatorColor:b,orientation:S,vertical:W,scrollButtons:w,textColor:K,variant:k,visibleScrollbar:he,fixed:!M,hideScrollbar:M&&!he,scrollableX:M&&!W,scrollableY:M&&W,centered:B&&!M,scrollButtonsHideMobile:!P}),$=Ut(U),Ke=de({elementType:E.StartScrollButtonIcon,externalSlotProps:z.startScrollButtonIcon,ownerState:U}),Ge=de({elementType:E.EndScrollButtonIcon,externalSlotProps:z.endScrollButtonIcon,ownerState:U}),[je,Je]=c.useState(!1),[X,Ie]=c.useState(De),[Te,Ze]=c.useState(!1),[Pe,Qe]=c.useState(!1),[Ee,et]=c.useState(!1),[ke,tt]=c.useState({overflow:"hidden",scrollbarWidth:0}),We=new Map,A=c.useRef(null),_=c.useRef(null),Me=()=>{const r=A.current;let s;if(r){const u=r.getBoundingClientRect();s={clientWidth:r.clientWidth,scrollLeft:r.scrollLeft,scrollTop:r.scrollTop,scrollLeftNormalized:It(r,a?"rtl":"ltr"),scrollWidth:r.scrollWidth,top:u.top,bottom:u.bottom,left:u.left,right:u.right}}let p;if(r&&O!==!1){const u=_.current.children;if(u.length>0){const g=u[We.get(O)];p=g?g.getBoundingClientRect():null}}return{tabsMeta:s,tabMeta:p}},Q=ge(()=>{const{tabsMeta:r,tabMeta:s}=Me();let p=0,u;if(W)u="top",s&&r&&(p=s.top-r.top+r.scrollTop);else if(u=a?"right":"left",s&&r){const j=a?r.scrollLeftNormalized+r.clientWidth-r.scrollWidth:r.scrollLeft;p=(a?-1:1)*(s[u]-r[u]+j)}const g={[u]:p,[Z]:s?s[Z]:0};if(isNaN(X[u])||isNaN(X[Z]))Ie(g);else{const j=Math.abs(X[u]-g[u]),R=Math.abs(X[Z]-g[Z]);(j>=1||R>=1)&&Ie(g)}}),me=(r,{animation:s=!0}={})=>{s?Mt(J,A.current,r,{duration:i.transitions.duration.standard}):A.current[J]=r},Re=r=>{let s=A.current[J];W?s+=r:(s+=r*(a?-1:1),s*=a&&Ve()==="reverse"?-1:1),me(s)},Le=()=>{const r=A.current[fe];let s=0;const p=Array.from(_.current.children);for(let u=0;u<p.length;u+=1){const g=p[u];if(s+g[fe]>r){u===0&&(s=r);break}s+=g[fe]}return s},ot=()=>{Re(-1*Le())},rt=()=>{Re(Le())},lt=c.useCallback(r=>{tt({overflow:null,scrollbarWidth:r})},[]),nt=()=>{const r={};r.scrollbarSizeListener=M?o.jsx(Kt,{onChange:lt,className:q($.scrollableX,$.hideScrollbar)}):null;const p=M&&(w==="auto"&&(Te||Pe)||w===!0);return r.scrollButtonStart=p?o.jsx(y,x({slots:{StartScrollButtonIcon:E.StartScrollButtonIcon},slotProps:{startScrollButtonIcon:Ke},orientation:S,direction:a?"right":"left",onClick:ot,disabled:!Te},N,{className:q($.scrollButtons,N.className)})):null,r.scrollButtonEnd=p?o.jsx(y,x({slots:{EndScrollButtonIcon:E.EndScrollButtonIcon},slotProps:{endScrollButtonIcon:Ge},orientation:S,direction:a?"left":"right",onClick:rt,disabled:!Pe},N,{className:q($.scrollButtons,N.className)})):null,r},ze=ge(r=>{const{tabsMeta:s,tabMeta:p}=Me();if(!(!p||!s)){if(p[re]<s[re]){const u=s[J]+(p[re]-s[re]);me(u,{animation:r})}else if(p[le]>s[le]){const u=s[J]+(p[le]-s[le]);me(u,{animation:r})}}}),ne=ge(()=>{M&&w!==!1&&et(!Ee)});c.useEffect(()=>{const r=Ue(()=>{A.current&&Q()});let s;const p=j=>{j.forEach(R=>{R.removedNodes.forEach(ee=>{var D;(D=s)==null||D.unobserve(ee)}),R.addedNodes.forEach(ee=>{var D;(D=s)==null||D.observe(ee)})}),r(),ne()},u=Xe(A.current);u.addEventListener("resize",r);let g;return typeof ResizeObserver<"u"&&(s=new ResizeObserver(r),Array.from(_.current.children).forEach(j=>{s.observe(j)})),typeof MutationObserver<"u"&&(g=new MutationObserver(p),g.observe(_.current,{childList:!0})),()=>{var j,R;r.clear(),u.removeEventListener("resize",r),(j=g)==null||j.disconnect(),(R=s)==null||R.disconnect()}},[Q,ne]),c.useEffect(()=>{const r=Array.from(_.current.children),s=r.length;if(typeof IntersectionObserver<"u"&&s>0&&M&&w!==!1){const p=r[0],u=r[s-1],g={root:A.current,threshold:.99},j=xe=>{Ze(!xe[0].isIntersecting)},R=new IntersectionObserver(j,g);R.observe(p);const ee=xe=>{Qe(!xe[0].isIntersecting)},D=new IntersectionObserver(ee,g);return D.observe(u),()=>{R.disconnect(),D.disconnect()}}},[M,w,Ee,I==null?void 0:I.length]),c.useEffect(()=>{Je(!0)},[]),c.useEffect(()=>{Q()}),c.useEffect(()=>{ze(De!==X)},[ze,X]),c.useImperativeHandle(m,()=>({updateIndicator:Q,updateScrollButtons:ne}),[Q,ne]);const Ne=o.jsx(Yt,x({},F,{className:q($.indicator,F.className),ownerState:U,style:x({},X,F.style)}));let se=0;const st=c.Children.map(I,r=>{if(!c.isValidElement(r))return null;const s=r.props.value===void 0?se:r.props.value;We.set(s,se);const p=s===O;return se+=1,c.cloneElement(r,x({fullWidth:k==="fullWidth",indicator:p&&!je&&Ne,selected:p,selectionFollowsFocus:L,onChange:f,textColor:K,value:s},se===1&&O===!1&&!r.props.tabIndex?{tabIndex:0}:{}))}),at=r=>{const s=_.current,p=pt(s).activeElement;if(p.getAttribute("role")!=="tab")return;let g=S==="horizontal"?"ArrowLeft":"ArrowUp",j=S==="horizontal"?"ArrowRight":"ArrowDown";switch(S==="horizontal"&&a&&(g="ArrowRight",j="ArrowLeft"),r.key){case g:r.preventDefault(),ae(s,p,$e);break;case j:r.preventDefault(),ae(s,p,Oe);break;case"Home":r.preventDefault(),ae(s,null,Oe);break;case"End":r.preventDefault(),ae(s,null,$e);break}},be=nt();return o.jsxs(Xt,x({className:q($.root,n),ownerState:U,ref:l,as:C},Ye,{children:[be.scrollButtonStart,be.scrollbarSizeListener,o.jsxs(_t,{className:$.scroller,ownerState:U,style:{overflow:ke.overflow,[W?`margin${a?"Left":"Right"}`:"marginBottom"]:he?void 0:-ke.scrollbarWidth},ref:A,children:[o.jsx(Vt,{"aria-label":h,"aria-labelledby":v,"aria-orientation":S==="vertical"?"vertical":null,className:$.flexContainer,ownerState:U,onKeyDown:at,ref:_,role:"tablist",children:st}),je&&Ne]}),be.scrollButtonEnd]}))}),Jt=()=>{const[e,t]=c.useState({password:"",confirmPassword:""}),l=i=>{const{name:a,value:h}=i.target;t({...e,[a]:h})},d=async()=>{if(e.password!==e.confirmPassword){alert("Passwords do not match!");return}const i=localStorage.getItem("token");if(!i){alert("No valid authentication token found.");return}try{const a=await fetch("http://localhost:5000/api/update-password",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({password:e.password})});if(a.ok)alert("Password updated successfully!");else{const h=await a.json();alert(`Error: ${h.message}`)}}catch(a){console.error("Error updating password:",a),alert("An error occurred while updating the password.")}};return o.jsx(ue,{sx:{p:4},children:o.jsx(ie,{children:o.jsxs(Se,{children:[o.jsx(oe,{variant:"h1",gutterBottom:!0,children:"Password"}),o.jsx(oe,{variant:"h3",color:"text.secondary",gutterBottom:!0,children:"Update password"}),o.jsxs(T,{container:!0,spacing:2,sx:{mt:1},children:[o.jsx(T,{item:!0,xs:12,children:o.jsx(V,{label:"Password",fullWidth:!0,type:"password",name:"password",value:e.password,onChange:l,required:!0})}),o.jsx(T,{item:!0,xs:12,children:o.jsx(V,{label:"Confirm password",fullWidth:!0,type:"password",name:"confirmPassword",value:e.confirmPassword,onChange:l,required:!0})})]}),o.jsx(ue,{sx:{textAlign:"right",mt:3},children:o.jsx(ce,{variant:"contained",color:"primary",onClick:d,children:"Update Password"})})]})})})},Zt=ht({nom:te().required("Le prénom est requis"),prenom:te().required("Le nom de famille est requis"),email:te().email("Adresse email invalide").required("L'email est requis"),adresse:te().required("L'adresse est requise"),telephone:te().required("Le numéro de téléphone est requis")}),oo=()=>{const[e,t]=c.useState({nom:"",prenom:"",email:"",adresse:"",telephone:"",profileImage:""}),[l,d]=c.useState(null),[i,a]=c.useState(!1),[h,v]=c.useState(0),m=ft(),B=mt(),I=b=>{try{const S=b.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),y=atob(S);return JSON.parse(y)}catch{return null}};c.useEffect(()=>{const b=localStorage.getItem("token");if(b){const f=I(b);if(f){const{nom:S,prenom:y,email:w,adresse:L,tel:E,profileImage:z}=f;t({nom:S||"",prenom:y||"",email:w||"",adresse:L||"",telephone:E||"",profileImage:z||"/default-avatar.png"})}}},[]);const n=bt({initialValues:{nom:e.nom,prenom:e.prenom,email:e.email,adresse:e.adresse,telephone:e.telephone},validationSchema:Zt,onSubmit:async b=>{const f=localStorage.getItem("token");if(!f){alert("Aucun token d'authentification valide trouvé.");return}const S=I(f);if(!S||S.email!==b.email){alert("L'email dans le formulaire ne correspond pas à l'email du token.");return}const y=new FormData;y.append("nom",b.nom),y.append("prenom",b.prenom),y.append("email",b.email),y.append("adresse",b.adresse),y.append("telephone",b.telephone),l&&y.append("profileImage",l);try{const w=await fetch("http://localhost:5000/api/update-profile",{method:"POST",headers:{Authorization:`Bearer ${f}`},body:y});if(w.ok){const L=await w.json();if(L.token){localStorage.setItem("token",L.token);const E=I(L.token);if(E){const{nom:z,prenom:F,email:N,adresse:K,telephone:O,profileImage:k}=E;t({nom:z||"",prenom:F||"",email:N||"",adresse:K||"",telephone:O||"",profileImage:k||"/default-avatar.png"})}}B(xt()),localStorage.removeItem("token"),a(!0),setTimeout(()=>{m("/login")},2e3)}else alert("Échec de la mise à jour du profil.")}catch(w){console.error("Erreur lors de la mise à jour du profil:",w),alert("Une erreur est survenue lors de la sauvegarde du profil.")}}}),C=b=>{const f=b.target.files[0];f&&(d(f),n.setFieldValue("profileImage",URL.createObjectURL(f)))},P=(b,f)=>{v(f)};return o.jsxs(o.Fragment,{children:[o.jsx(gt,{children:o.jsx("title",{children:"Profil"})}),o.jsx(jt,{}),o.jsxs(ue,{sx:{p:4,marginTop:"100px"},children:[o.jsxs(vt,{"aria-label":"breadcrumb",sx:{mb:2},children:[o.jsx(Ae,{underline:"hover",color:"inherit",href:"/Home",children:"Home"}),o.jsx(Ae,{underline:"hover",color:"inherit",href:"/profile",children:"Mon profil"}),o.jsx(oe,{color:"text.primary",variant:"h2",children:"Modifier mon profil"})]}),o.jsxs(Gt,{value:h,onChange:P,"aria-label":"Profile tabs",sx:{mb:3},children:[o.jsx(Fe,{label:"Informations personnelles"}),o.jsx(Fe,{label:"Changer de mot de passe"})]}),o.jsxs(T,{container:!0,spacing:4,children:[h===0&&o.jsx(T,{item:!0,xs:12,md:12,children:o.jsx(ie,{children:o.jsxs(T,{container:!0,spacing:4,children:[o.jsx(T,{item:!0,xs:12,md:4,children:o.jsxs(ie,{children:[o.jsx("img",{height:"240",src:e.profileImage||"/default-avatar.png",alt:"User profile",style:{width:"50%",objectFit:"cover",borderRadius:"200px",marginLeft:"100px"}}),o.jsxs(Se,{children:[o.jsx(St,{sx:{my:2}}),o.jsxs(ce,{fullWidth:!0,variant:"contained",component:"label",sx:{display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"},padding:"10px 20px",borderRadius:"8px",textTransform:"none",fontWeight:"bold"},children:["Télécharger une image",o.jsx("input",{type:"file",hidden:!0,onChange:C,accept:"image/*"})]})]})]})}),o.jsx(T,{item:!0,xs:12,md:8,children:o.jsx(ie,{children:o.jsxs(Se,{children:[o.jsx(oe,{variant:"h2",gutterBottom:!0,children:"Mettre à jour le profil"}),o.jsxs("form",{onSubmit:n.handleSubmit,children:[o.jsxs(T,{container:!0,spacing:2,sx:{mt:1},children:[o.jsx(T,{item:!0,xs:12,md:6,children:o.jsx(V,{label:"Prénom",fullWidth:!0,required:!0,name:"nom",value:n.values.nom,onChange:n.handleChange,onBlur:n.handleBlur,error:n.touched.nom&&!!n.errors.nom,helperText:n.touched.nom&&n.errors.nom})}),o.jsx(T,{item:!0,xs:12,md:6,children:o.jsx(V,{label:"Nom de famille",fullWidth:!0,required:!0,name:"prenom",value:n.values.prenom,onChange:n.handleChange,onBlur:n.handleBlur,error:n.touched.prenom&&!!n.errors.prenom,helperText:n.touched.prenom&&n.errors.prenom})}),o.jsx(T,{item:!0,xs:12,md:6,children:o.jsx(V,{label:"Adresse e-mail",fullWidth:!0,required:!0,name:"email",value:n.values.email,onChange:n.handleChange,onBlur:n.handleBlur,error:n.touched.email&&!!n.errors.email,helperText:n.touched.email&&n.errors.email})}),o.jsx(T,{item:!0,xs:12,md:6,children:o.jsx(V,{label:"Adresse",fullWidth:!0,required:!0,name:"adresse",value:n.values.adresse,onChange:n.handleChange,onBlur:n.handleBlur,error:n.touched.adresse&&!!n.errors.adresse,helperText:n.touched.adresse&&n.errors.adresse})}),o.jsx(T,{item:!0,xs:12,md:6,children:o.jsx(V,{label:"Téléphone",fullWidth:!0,required:!0,name:"telephone",value:n.values.telephone,onChange:n.handleChange,onBlur:n.handleBlur,error:n.touched.telephone&&!!n.errors.telephone,helperText:n.touched.telephone&&n.errors.telephone})})]}),o.jsx(ue,{sx:{textAlign:"right",mt:3},children:o.jsx(ce,{type:"submit",variant:"contained",color:"primary",children:"Sauvegarder les détails"})})]})]})})})]})})}),h===1&&o.jsx(Jt,{})]})]}),o.jsxs(yt,{open:i,onClose:()=>a(!1),children:[o.jsx(Ct,{children:"Mise à jour réussie"}),o.jsx(wt,{children:o.jsx(oe,{style:{textAlign:"center"},children:"Votre profil a été mis à jour avec succès !"})}),o.jsx(Bt,{children:o.jsx(ce,{onClick:()=>a(!1),color:"primary",children:"OK"})})]})]})};export{oo as default};
