import{m as p,r as n,j as e,H as u,B as j,a_ as g,T as t,v as f,R as b,w as v,G as d,aB as y,a$ as L,aI as I,t as O}from"./index-DL1FNKyW.js";import{E}from"./appbar-CV8vv-7y.js";import{L as S}from"./Link-CurVFiB1.js";import{L as B,a as P}from"./ListItem-CSUaVkfV.js";const A=()=>{const o=p(),[i,l]=n.useState([]),[x,c]=n.useState(!0),h=async()=>{c(!0);const s=JSON.parse(localStorage.getItem("user")),r=s?s.userId:null;if(console.log("Fetching orders for userId:",r),!r){console.error("User ID is missing or invalid."),alert("User not logged in or invalid user data."),c(!1);return}try{const a=await O.get(`http://localhost:5000/api/orders/${r}`);console.log("API Response:",a.data),l(a.data.orders)}catch(a){console.error("Error fetching orders:",a),a.response&&console.error("API responded with:",a.response.data),alert("Failed to fetch orders. Please try again later.")}finally{c(!1)}};n.useEffect(()=>{h()},[]),n.useEffect(()=>{console.log("Orders:",i)},[i]);const m=(s,r)=>({height:24,padding:"0 6px",color:s,backgroundColor:r,marginRight:"5px"});return e.jsxs(e.Fragment,{children:[e.jsx(u,{children:e.jsx("title",{children:"Orders"})}),e.jsx(E,{}),e.jsxs(j,{sx:{p:4,marginTop:"100px"},children:[e.jsxs(g,{"aria-label":"breadcrumb",sx:{mb:2},children:[e.jsx(S,{underline:"hover",color:"inherit",href:"/Home",children:"Home"}),e.jsx(t,{color:"text.primary",variant:"h4",children:"My Orders"})]}),x?e.jsx(t,{variant:"body1",children:"Loading..."}):e.jsx(f,{sx:{maxWidth:"100%",py:0,borderRadius:"10px"},children:i.length===0?e.jsx(t,{variant:"body1",children:"No orders found."}):i.map((s,r)=>e.jsxs(b.Fragment,{children:[e.jsx("img",{alt:"Order Item",src:s.img,width:200}),e.jsxs(B,{sx:{p:2,borderBottom:"1px solid",borderColor:"divider"},children:[e.jsx(v,{primary:e.jsxs(t,{variant:"subtitle1",children:["Order #",s.idCmd]}),secondary:e.jsx(t,{variant:"body2",children:"Order details and description"})}),e.jsxs(P,{children:[e.jsx(t,{variant:"caption",children:s.DateCreaction}),e.jsx("br",{})]})]}),e.jsxs(d,{container:!0,direction:"column",sx:{pl:7,pb:2},children:[e.jsxs(d,{item:!0,children:[e.jsxs(t,{variant:"body2",children:["Mode Paiement: ",s.modePaiement,e.jsx("br",{}),"Mode Livraison: ",s.ModeLivraison]}),e.jsxs(t,{variant:"body2",children:["Delais de Livraison: ",s.DelaisLivraison,e.jsx("br",{})]})]}),e.jsx(d,{item:!0,children:e.jsxs(y,{direction:"row",spacing:2,mt:1,children:["statue :",e.jsx(L,{label:s.statue,sx:m((s.statue==="success",o.palette.success),(s.statue==="success",o.palette.success))})]})})]}),r!==i.length-1&&e.jsx(I,{})]},r))})]})]})};export{A as default};
