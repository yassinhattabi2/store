import{af as w,ag as S,j as e,H as v,a4 as C,t as k,ah as h,a1 as I,a2 as g}from"./index-CLLn0rYl.js";import{C as q,a as B,B as i,T as c,S as m,F as u,b as j,I as f,c as D,d as E}from"./ErrorOutline-BCFI52ru.js";import{E as F}from"./appbar-D_RuDL8j.js";import{L as y}from"./Link-BK6r3GgC.js";import{D as R,C as L}from"./Divider-BzUTNrhk.js";const P=I().shape({email:g().email("Invalid email format").required("Email is required"),password:g().min(6,"Password must be at least 6 characters").required("Password is required")}),b=({message:n})=>e.jsxs(i,{sx:{display:"flex",alignItems:"center",backgroundColor:"rgba(255, 0, 0, 0.1)",color:"red",padding:"8px 12px",borderRadius:"4px",marginTop:"4px"},children:[e.jsx(E,{sx:{marginRight:1}}),e.jsx(c,{level:"body-xs",children:n})]});function A(){const n=w(),p=S();return e.jsxs(e.Fragment,{children:[e.jsx(v,{children:e.jsx("title",{children:"Sigin in"})}),e.jsx(F,{}),e.jsxs(q,{disableTransitionOnChange:!0,children:[e.jsx(B,{}),e.jsx(i,{sx:{width:{xs:"100%",md:"50vw"},position:"relative",zIndex:1,display:"flex",marginLeft:"25%",justifyContent:"flex-end",backdropFilter:"blur(12px)",backgroundColor:"rgba(255 255 255 / 0.2)"},children:e.jsxs(i,{sx:{display:"flex",flexDirection:"column",minHeight:"100dvh",width:"100%",px:2},children:[e.jsx(i,{component:"header",sx:{py:3,display:"flex",justifyContent:"space-between"},children:e.jsx(i,{sx:{gap:2,display:"flex",alignItems:"center"},children:e.jsx(c,{level:"title-lg",children:"Water Day"})})}),e.jsxs(i,{component:"main",sx:{my:"auto",py:2,pb:5,display:"flex",flexDirection:"column",gap:2,width:400,maxWidth:"100%",mx:"auto",borderRadius:"sm"},children:[e.jsx(m,{sx:{gap:4,mb:2},children:e.jsxs(m,{sx:{gap:1},children:[e.jsx(c,{component:"h1",level:"h3",children:"Sign in"}),e.jsxs(c,{level:"body-sm",children:[" ",e.jsx(y,{href:"register",level:"title-sm",children:"Sign up!"})]})]})}),e.jsx(R,{children:"or"}),e.jsx(m,{sx:{gap:4,mt:2},children:e.jsx(C,{initialValues:{email:"",password:"",persistent:!1},validationSchema:P,onSubmit:async(l,{setSubmitting:t,setErrors:r})=>{try{const s=await k.post("http://localhost:5000/api/signin",{email:l.email,password:l.password}),{role:a,statue:x,token:o,...d}=s.data;if(a==="client"){if(x!=="Bloqué"){if(x==="Débloqué"){localStorage.setItem("token",o),localStorage.setItem("user",JSON.stringify(d)),p(h({token:o,user:d})),n("/home");return}}}else if(a==="admin"&&x===""){localStorage.setItem("token",o),localStorage.setItem("user",JSON.stringify(d)),p(h({token:o,user:d})),n("/dashboard/admin");return}r({email:"your Account is not active"})}catch(s){console.error("Error during sign-in:",s),r({email:"Invalid account"})}finally{t(!1)}},children:({handleSubmit:l,handleChange:t,values:r,errors:s,touched:a})=>e.jsxs("form",{onSubmit:l,children:[e.jsxs(u,{required:!0,children:[e.jsx(j,{children:"Email"}),e.jsx(f,{type:"email",name:"email",value:r.email,onChange:t,error:a.email&&!!s.email}),a.email&&s.email&&e.jsx(b,{message:s.email})]}),e.jsxs(u,{required:!0,children:[e.jsx(j,{children:"Password"}),e.jsx(f,{type:"password",name:"password",value:r.password,onChange:t,error:a.password&&!!s.password}),a.password&&s.password&&e.jsx(b,{message:s.password})]}),e.jsxs(m,{sx:{gap:4,mt:2},children:[e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(L,{label:"Remember me",name:"persistent",checked:r.persistent,onChange:t}),e.jsx(y,{level:"title-sm",href:"forget-password",children:"Forgot your password?"})]}),e.jsx(D,{type:"submit",style:{fontSize:"16px"},sx:{backgroundColor:"black"},children:"Sign in"})]})]})})})]})]})})]})]})}export{A as default};
